

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Action Scheme &mdash; TensorTrade 1.0.0-beta documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reward Scheme" href="reward_scheme.html" />
    <link rel="prev" title="Components" href="components.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html#docker">Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/overview.html">Code Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/setup_environment_tutorial.html">Setup Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/train_and_evaluate.html">Train and Evaluate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/renderers_and_plotly_chart.html">Renderers and Plotly Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/use_stochastic_data.html">Stochastic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ledger_example.html">Ledger Example</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ray.html">Using Ray with TensorTrade</a></li>
</ul>
<p class="caption"><span class="caption-text">Components</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Action Scheme</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-an-action">What is an Action?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#default">Default</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple">Simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="#managedrisk">ManagedRisk</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bsh">BSH</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reward_scheme.html">Reward Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="observer.html">Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="observer.html#default">Default</a></li>
<li class="toctree-l1"><a class="reference internal" href="stopper.html">Stopper</a></li>
<li class="toctree-l1"><a class="reference internal" href="informer.html">Informer</a></li>
<li class="toctree-l1"><a class="reference internal" href="renderer.html">Renderer</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../envs/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../envs/overview.html#what-if-i-can-t-make-a-particular-environment">What if I can’t make a particular environment?</a></li>
</ul>
<p class="caption"><span class="caption-text">Feed</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#what-is-a-stream">What is a <code class="docutils literal notranslate"><span class="pre">Stream</span></code>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#using-data-types">Using Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#advanced-usages">Advanced Usages</a></li>
</ul>
<p class="caption"><span class="caption-text">Order Management System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html#portfolio">Portfolio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html#orders">Orders</a></li>
</ul>
<p class="caption"><span class="caption-text">Agents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#ray">Ray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#stable-baselines">Stable Baselines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#tensorforce">Tensorforce</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">API reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TensorTrade</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Action Scheme</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/components/action_scheme.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="action-scheme">
<h1>Action Scheme<a class="headerlink" href="#action-scheme" title="Permalink to this headline">¶</a></h1>
<p>An <code class="docutils literal notranslate"><span class="pre">ActionScheme</span></code> defines the action space of the environment and interprets the action of an agent and how it gets applied to the environment.</p>
<p>For example, if we were using a discrete action space of 3 actions (0 = hold, 1 = buy 100 %, 2 = sell 100%), our learning agent does not need to know that returning an action of 1 is equivalent to buying an instrument. Rather, the agent needs to know the reward for returning an action of 1 in specific circumstances, and can leave the implementation details of converting actions to trades to the <code class="docutils literal notranslate"><span class="pre">ActionScheme</span></code>.</p>
<p>Each action scheme has a <code class="docutils literal notranslate"><span class="pre">perform</span></code> method, which will interpret the agent’s specified action into a change in the environmental state. It is often necessary to store additional state within the scheme, for example to keep track of the currently traded position. This state should be reset each time the action scheme’s reset method is called, which is done automatically when the parent <code class="docutils literal notranslate"><span class="pre">TradingEnv</span></code> is reset.</p>
<div class="section" id="what-is-an-action">
<h2>What is an Action?<a class="headerlink" href="#what-is-an-action" title="Permalink to this headline">¶</a></h2>
<p>This is a review of what was mentioned inside of the overview section and explains how a RL operates. You’ll better understand what an action is in context of an observation space and reward. At the same time, hopefully this will be a proper refresher.</p>
<p>An action is a predefined value of how the machine should move inside of the world. To better summarize, its a <em>command that a player would give inside of a video game in respose to a stimuli</em>. The commands usually come in the form of an <code class="docutils literal notranslate"><span class="pre">action_space</span></code>. An <code class="docutils literal notranslate"><span class="pre">action_space</span></code> defines the rules for how a user is allowed to act inside of an environment. While it might not be easily interpretable by humans, it can easily be interpreted by a machine.</p>
<p>Let’s look at a good example. Let’s say we’re trying to balance a cart with a pole on it (cartpole). We can choose to move the cart left and right. This is a <code class="docutils literal notranslate"><span class="pre">Discrete(2)</span></code> action space.</p>
<ul class="simple">
<li><p>0 - Push cart to the left</p></li>
<li><p>1 - Push cart to the right</p></li>
</ul>
<p>When we get the action from the agent, the environment will see that number instead of a name.</p>
<p><img alt="Watch Link Run Around In Circles" src="../_images/cartpole.gif" /></p>
<p>An <code class="docutils literal notranslate"><span class="pre">ActionScheme</span></code> supports any type of action space that subclasses <code class="docutils literal notranslate"><span class="pre">Space</span></code> from <code class="docutils literal notranslate"><span class="pre">gym</span></code>. For example, here is an implementation of an action space that represents a probability simplex.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">gym.spaces</span> <span class="kn">import</span> <span class="n">Space</span>

<span class="k">class</span> <span class="nc">Simplex</span><span class="p">(</span><span class="n">Space</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">2</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>

    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">*</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()])</span>

    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="section" id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this headline">¶</a></h2>
<p>The default TensorTrade action scheme is made to be compatible with the built-in order management system (OMS). The OMS is a system that is able to have orders be submitted to it for particular financial instruments.</p>
<div class="section" id="simple">
<h3>Simple<a class="headerlink" href="#simple" title="Permalink to this headline">¶</a></h3>
<p><br><strong>Overview</strong><br>
A discrete action scheme that determines actions based on a list of
trading pairs, order criteria, and trade sizes.</p>
<p><br><strong>Action Space</strong><br>
The action space is a discrete set of N options. The total number of discrete actions is the product of</p>
<ul class="simple">
<li><p>criteria (order criteria for order creation/completion)</p></li>
<li><p>trade sizes (e.g. 1/4, 1/2, 1/3)</p></li>
<li><p>trade durations (e.g. order open for 30 seconds or 60 seconds)</p></li>
<li><p>trade sides (i.e. Buy or Sell)</p></li>
<li><p>the number of tradeable pairs (i.e. BTC/USDT, ETH/BTC, etc)</p></li>
</ul>
<p><br><strong>Perform</strong><br>
Performs as per TensorTradeActionScheme, creates order based on models discrete output and submits it to the broker. The state action mapping varies with the parameters above.</p>
</div>
<div class="section" id="managedrisk">
<h3>ManagedRisk<a class="headerlink" href="#managedrisk" title="Permalink to this headline">¶</a></h3>
<p><br><strong>Overview</strong><br>
A discrete action scheme that determines actions based on managing risk,
through setting a follow-up stop loss and take profit on every order.</p>
<p><br><strong>Action Space</strong><br>
The action space is a discrete set of N options for the model to take. The total number of discrete actions is determined by taking a product of:</p>
<ul class="simple">
<li><p>stop percents (i.e. [0.02, 0.04, 0.06] percent changes to trigger a stop loss)</p></li>
<li><p>take percents (i.e. [0.02, 0.03] value percent changes to take profit at)</p></li>
<li><p>trade sizes (e.g. 1/4, 1/2, 1/3)</p></li>
<li><p>trade durations (e.g. order open for 30 seconds or 60 seconds)</p></li>
<li><p>trade sides (i.e. Buy or Sell)</p></li>
<li><p>the number of tradable pairs (i.e. BTC/USDT, ETH/BTC, etc)</p></li>
</ul>
<p><br><strong>Perform</strong><br>
Performs as per TensorTradeActionScheme, creates order based on models discrete output and submits it to the broker. The state action mapping varies with the parameters above.</p>
</div>
<div class="section" id="bsh">
<h3>BSH<a class="headerlink" href="#bsh" title="Permalink to this headline">¶</a></h3>
<p><br> <strong>Overview</strong> <br>
The buy/sell/hold (BSH) action scheme was made to capture the simplest type of
action space that can be made. If the agent is in state 0, then all of its net worth
is located in our <code class="docutils literal notranslate"><span class="pre">cash</span></code> wallet (e.g. USD). If the agent is in state 1, then all of
its net worth is located in our <code class="docutils literal notranslate"><span class="pre">asset</span></code> wallet (e.g. BTC).</p>
<p><br> <strong>Action Space</strong> <br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Discrete(2)</span></code> options, buy or sell</p></li>
</ul>
<p><br> <strong>Perform</strong> <br>
Below is a table that shows the mapping <code class="docutils literal notranslate"><span class="pre">(state,</span> <span class="pre">action)</span> <span class="pre">-&gt;</span> <span class="pre">(state)</span></code>. <br></p>
<table border="1" class="docutils">
<thead>
<tr>
<th>State</th>
<th>Action</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>Keep net worth in <code>cash</code> wallet (HOLD)</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>Transition net worth from <code>cash</code> wallet to <code>asset</code> wallet (BUY)</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>Transition net worth from <code>asset</code> wallet to <code>cash</code> wallet. (SELL)</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>Keep net worth in <code>asset</code> wallet (HOLD)</td>
</tr>
</tbody>
</table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reward_scheme.html" class="btn btn-neutral float-right" title="Reward Scheme" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="components.html" class="btn btn-neutral float-left" title="Components" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>