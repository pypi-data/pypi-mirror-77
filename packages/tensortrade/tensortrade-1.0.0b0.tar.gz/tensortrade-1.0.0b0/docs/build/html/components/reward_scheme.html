

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reward Scheme &mdash; TensorTrade 1.0.0-beta documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Observer" href="observer.html" />
    <link rel="prev" title="Action Scheme" href="action_scheme.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html#docker">Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/overview.html">Code Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/setup_environment_tutorial.html">Setup Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/train_and_evaluate.html">Train and Evaluate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/renderers_and_plotly_chart.html">Renderers and Plotly Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/use_stochastic_data.html">Stochastic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ledger_example.html">Ledger Example</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ray.html">Using Ray with TensorTrade</a></li>
</ul>
<p class="caption"><span class="caption-text">Components</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="action_scheme.html">Action Scheme</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reward Scheme</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#default">Default</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-profit">Simple Profit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#risk-adjusted-returns">Risk Adjusted Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="observer.html">Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="observer.html#default">Default</a></li>
<li class="toctree-l1"><a class="reference internal" href="stopper.html">Stopper</a></li>
<li class="toctree-l1"><a class="reference internal" href="informer.html">Informer</a></li>
<li class="toctree-l1"><a class="reference internal" href="renderer.html">Renderer</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../envs/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../envs/overview.html#what-if-i-can-t-make-a-particular-environment">What if I can’t make a particular environment?</a></li>
</ul>
<p class="caption"><span class="caption-text">Feed</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#what-is-a-stream">What is a <code class="docutils literal notranslate"><span class="pre">Stream</span></code>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#using-data-types">Using Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#advanced-usages">Advanced Usages</a></li>
</ul>
<p class="caption"><span class="caption-text">Order Management System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html#portfolio">Portfolio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html#orders">Orders</a></li>
</ul>
<p class="caption"><span class="caption-text">Agents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#ray">Ray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#stable-baselines">Stable Baselines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#tensorforce">Tensorforce</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">API reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TensorTrade</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Reward Scheme</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/components/reward_scheme.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="reward-scheme">
<h1>Reward Scheme<a class="headerlink" href="#reward-scheme" title="Permalink to this headline">¶</a></h1>
<p>Reward schemes receive the <code class="docutils literal notranslate"><span class="pre">TradingEnv</span></code> at each time step and return a <code class="docutils literal notranslate"><span class="pre">float</span></code>, corresponding to the benefit of that specific action. For example, if the action taken this step was a sell that resulted in positive profits, our <code class="docutils literal notranslate"><span class="pre">RewardScheme</span></code> could return a positive number to encourage more trades like this. On the other hand, if the action was a sell that resulted in a loss, the scheme could return a negative reward to teach the agent not to make similar actions in the future.</p>
<p>A version of this example algorithm is implemented in <code class="docutils literal notranslate"><span class="pre">SimpleProfit</span></code>, however more complex schemes can obviously be used instead.</p>
<p>Each reward scheme has a <code class="docutils literal notranslate"><span class="pre">reward</span></code> method, which takes in the <code class="docutils literal notranslate"><span class="pre">TradingEnv</span></code> at each time step and returns a <code class="docutils literal notranslate"><span class="pre">float</span></code> corresponding to the value of that action. As with action schemes, it is often necessary to store additional state within a reward scheme for various reasons. This state should be reset each time the reward scheme’s reset method is called, which is done automatically when the environment is reset.</p>
<p>Ultimately the agent creates a sequence of actions to maximize its total reward over a given time. The <code class="docutils literal notranslate"><span class="pre">RewardScheme</span></code> is an abstract class that encapsulates how to tell the trading bot in <code class="docutils literal notranslate"><span class="pre">tensortrade</span></code> if it’s trading positively or negatively over time. The same methods will be called each time for each step, and we can directly swap out compatible schemes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensortrade.env.default.rewards</span> <span class="kn">import</span> <span class="n">SimpleProfit</span>

<span class="n">reward_scheme</span> <span class="o">=</span> <span class="n">SimpleProfit</span><span class="p">()</span>
</pre></div>
</div>
<p><em>The simple profit scheme returns a reward of -1 for not holding a trade, 1 for holding a trade, 2 for purchasing an instrument, and a value corresponding to the (positive/negative) profit earned by a trade if an instrument was sold.</em></p>
<div class="section" id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this headline">¶</a></h2>
<p>These are the default reward schemes.</p>
<hr><div class="section" id="simple-profit">
<h3>Simple Profit<a class="headerlink" href="#simple-profit" title="Permalink to this headline">¶</a></h3>
<p>A reward scheme that rewards the agent for profitable trades and prioritizes trading over not trading.</p>
<p><br><strong>Overview</strong><br>
The simple profit scheme needs to keep a history of profit over time. The way it does this is through looking at the portfolio as a means of keeping track of how the portfolio moves. This is seen inside of the <code class="docutils literal notranslate"><span class="pre">get_reward</span></code> function.</p>
<p><br><strong>Computing Reward</strong><br>
<br><strong>Compatibility</strong><br></p>
<hr></div>
<div class="section" id="risk-adjusted-returns">
<h3>Risk Adjusted Returns<a class="headerlink" href="#risk-adjusted-returns" title="Permalink to this headline">¶</a></h3>
<p>A reward scheme that rewards the agent for increasing its net worth, while penalizing more volatile strategies.</p>
<p><br><strong>Overview</strong><br>
When trading you often are not just looking at the overall returns of your model. You’re also looking at the overall volatility of your trading strategy over time compared to other metrics. The two major strategies here are the sharpe and sortino ratio.</p>
<p>The <strong>sharpe ratio</strong> looks at the overall movements of the portfolio and generates a penalty for massive movements through a lower score. This includes major movements towards the upside and downside.</p>
<p><img alt="Sharpe Ratio" src="../_images/sharpe.png" /></p>
<p>The <strong>sortino ratio</strong> takes the same idea, though it focuses more on penalizing only the upside. That means it’ll give a huge score for moments when the price moves upward, and will only give a negative score when the price drops heavily. This is a great direction for the RL algorithm. Seeing that we don’t want to incur heavy downsides, yet want to take on large upsides, using this metric alone gives us lots of progress to mititgate downsides and increase upsides.</p>
<p><img alt="Sortino Ratio" src="../_images/sortino.png" /></p>
<p><br><strong>Computing Reward</strong><br>
Given the choice of <code class="docutils literal notranslate"><span class="pre">return_algorithm</span></code> the reward is computed using the <code class="docutils literal notranslate"><span class="pre">risk_free_rate</span></code> and the <code class="docutils literal notranslate"><span class="pre">target_returns</span></code> parameters.</p>
<p><br><strong>Compatibility</strong><br></p>
<hr></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="observer.html" class="btn btn-neutral float-right" title="Observer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="action_scheme.html" class="btn btn-neutral float-left" title="Action Scheme" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>