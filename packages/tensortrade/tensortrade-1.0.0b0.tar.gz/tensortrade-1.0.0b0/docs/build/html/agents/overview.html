

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Overview &mdash; TensorTrade 1.0.0-beta documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tensortrade" href="../api/modules.html" />
    <link rel="prev" title="Overview" href="../oms/overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html#docker">Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/overview.html">Code Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/setup_environment_tutorial.html">Setup Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/train_and_evaluate.html">Train and Evaluate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/renderers_and_plotly_chart.html">Renderers and Plotly Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/use_stochastic_data.html">Stochastic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ledger_example.html">Ledger Example</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ray.html">Using Ray with TensorTrade</a></li>
</ul>
<p class="caption"><span class="caption-text">Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../components/components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/action_scheme.html">Action Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/reward_scheme.html">Reward Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/observer.html">Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/observer.html#default">Default</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/stopper.html">Stopper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/informer.html">Informer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/renderer.html">Renderer</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../envs/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../envs/overview.html#what-if-i-can-t-make-a-particular-environment">What if I can’t make a particular environment?</a></li>
</ul>
<p class="caption"><span class="caption-text">Feed</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#what-is-a-stream">What is a <code class="docutils literal notranslate"><span class="pre">Stream</span></code>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#using-data-types">Using Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feed/overview.html#advanced-usages">Advanced Usages</a></li>
</ul>
<p class="caption"><span class="caption-text">Order Management System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html#portfolio">Portfolio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html#orders">Orders</a></li>
</ul>
<p class="caption"><span class="caption-text">Agents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="#ray">Ray</a></li>
<li class="toctree-l1"><a class="reference internal" href="#stable-baselines">Stable Baselines</a></li>
<li class="toctree-l1"><a class="reference internal" href="#tensorforce">Tensorforce</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">API reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TensorTrade</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/agents/overview.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>This is where the “deep” part of the deep reinforcement learning framework come in. Learning agents are where the math (read: magic) happens.</p>
<p>At each time step, the agent takes the observation from the environment as input, runs it through its underlying model (a neural network most of the time), and outputs the action to take. For example, the observation might be the previous <code class="docutils literal notranslate"><span class="pre">open</span></code>, <code class="docutils literal notranslate"><span class="pre">high</span></code>, <code class="docutils literal notranslate"><span class="pre">low</span></code>, and <code class="docutils literal notranslate"><span class="pre">close</span></code> price from the exchange. The learning model would take these values as input and output a value corresponding to the action to take, such as <code class="docutils literal notranslate"><span class="pre">buy</span></code>, <code class="docutils literal notranslate"><span class="pre">sell</span></code>, or <code class="docutils literal notranslate"><span class="pre">hold</span></code>.</p>
<p>It is important to remember the learning model has no intuition of the prices or trades being represented by these values. Rather, the model is simply learning which values to output for specific input values or sequences of input values, to earn the highest reward.</p>
<p>In this example, we will be using the Stable Baselines library to provide learning agents to our trading scheme, however, the TensorTrade framework is compatible with many reinforcement learning libraries such as Tensorforce, Ray’s RLLib, OpenAI’s Baselines, Intel’s Coach, or anything from the TensorFlow line such as TF Agents.</p>
<p>It is possible that custom TensorTrade learning agents will be added to this framework in the future, though it will always be a goal of the framework to be interoperable with as many existing reinforcement learning libraries as possible, since there is so much concurrent growth in the space.
But for now, Stable Baselines is simple and powerful enough for our needs.</p>
</div>
<div class="section" id="ray">
<h1><a class="reference external" href="https://docs.ray.io/en/latest/rllib.html">Ray</a><a class="headerlink" href="#ray" title="Permalink to this headline">¶</a></h1>
<p>The following is an example of how to train a strategy on <code class="docutils literal notranslate"><span class="pre">ray</span></code> using the <code class="docutils literal notranslate"><span class="pre">PPO</span></code>
algorithm.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ray</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">ray</span> <span class="kn">import</span> <span class="n">tune</span>
<span class="kn">from</span> <span class="nn">ray.tune.registry</span> <span class="kn">import</span> <span class="n">register_env</span>

<span class="kn">import</span> <span class="nn">tensortrade.env.default</span> <span class="k">as</span> <span class="nn">default</span>

<span class="kn">from</span> <span class="nn">tensortrade.feed.core</span> <span class="kn">import</span> <span class="n">DataFeed</span><span class="p">,</span> <span class="n">Stream</span>
<span class="kn">from</span> <span class="nn">tensortrade.oms.instruments</span> <span class="kn">import</span> <span class="n">Instrument</span>
<span class="kn">from</span> <span class="nn">tensortrade.oms.exchanges</span> <span class="kn">import</span> <span class="n">Exchange</span>
<span class="kn">from</span> <span class="nn">tensortrade.oms.services.execution.simulated</span> <span class="kn">import</span> <span class="n">execute_order</span>
<span class="kn">from</span> <span class="nn">tensortrade.oms.wallets</span> <span class="kn">import</span> <span class="n">Wallet</span><span class="p">,</span> <span class="n">Portfolio</span>


<span class="n">USD</span> <span class="o">=</span> <span class="n">Instrument</span><span class="p">(</span><span class="s2">&quot;USD&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;U.S. Dollar&quot;</span><span class="p">)</span>
<span class="n">TTC</span> <span class="o">=</span> <span class="n">Instrument</span><span class="p">(</span><span class="s2">&quot;TTC&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;TensorTrade Coin&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_env</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;USD-TTC&quot;</span><span class="p">)</span>

    <span class="n">coinbase</span> <span class="o">=</span> <span class="n">Exchange</span><span class="p">(</span><span class="s2">&quot;coinbase&quot;</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="n">execute_order</span><span class="p">)(</span>
        <span class="n">p</span>
    <span class="p">)</span>

    <span class="n">cash</span> <span class="o">=</span> <span class="n">Wallet</span><span class="p">(</span><span class="n">coinbase</span><span class="p">,</span> <span class="mi">100000</span> <span class="o">*</span> <span class="n">USD</span><span class="p">)</span>
    <span class="n">asset</span> <span class="o">=</span> <span class="n">Wallet</span><span class="p">(</span><span class="n">coinbase</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">TTC</span><span class="p">)</span>

    <span class="n">portfolio</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">USD</span><span class="p">,</span> <span class="p">[</span>
        <span class="n">cash</span><span class="p">,</span>
        <span class="n">asset</span>
    <span class="p">])</span>

    <span class="n">feed</span> <span class="o">=</span> <span class="n">DataFeed</span><span class="p">([</span>
        <span class="n">p</span><span class="p">,</span>
        <span class="n">p</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;fast&quot;</span><span class="p">),</span>
        <span class="n">p</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;medium&quot;</span><span class="p">),</span>
        <span class="n">p</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;slow&quot;</span><span class="p">),</span>
        <span class="n">p</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;lr&quot;</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="n">reward_scheme</span> <span class="o">=</span> <span class="n">default</span><span class="o">.</span><span class="n">rewards</span><span class="o">.</span><span class="n">PBR</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

    <span class="n">action_scheme</span> <span class="o">=</span> <span class="n">default</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">BSH</span><span class="p">(</span>
        <span class="n">cash</span><span class="o">=</span><span class="n">cash</span><span class="p">,</span>
        <span class="n">asset</span><span class="o">=</span><span class="n">asset</span>
    <span class="p">)</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">reward_scheme</span><span class="p">)</span>

    <span class="n">env</span> <span class="o">=</span> <span class="n">default</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">feed</span><span class="o">=</span><span class="n">feed</span><span class="p">,</span>
        <span class="n">portfolio</span><span class="o">=</span><span class="n">portfolio</span><span class="p">,</span>
        <span class="n">action_scheme</span><span class="o">=</span><span class="n">action_scheme</span><span class="p">,</span>
        <span class="n">reward_scheme</span><span class="o">=</span><span class="n">reward_scheme</span><span class="p">,</span>
        <span class="n">window_size</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;window_size&quot;</span><span class="p">],</span>
        <span class="n">max_allowed_loss</span><span class="o">=</span><span class="mf">0.6</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">env</span>

<span class="n">register_env</span><span class="p">(</span><span class="s2">&quot;TradingEnv&quot;</span><span class="p">,</span> <span class="n">create_env</span><span class="p">)</span>


<span class="n">analysis</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="s2">&quot;PPO&quot;</span><span class="p">,</span>
    <span class="n">stop</span><span class="o">=</span><span class="p">{</span>
      <span class="s2">&quot;episode_reward_mean&quot;</span><span class="p">:</span> <span class="mi">500</span>
    <span class="p">},</span>
    <span class="n">config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;env&quot;</span><span class="p">:</span> <span class="s2">&quot;TradingEnv&quot;</span><span class="p">,</span>
        <span class="s2">&quot;env_config&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">25</span>
        <span class="p">},</span>
        <span class="s2">&quot;log_level&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;framework&quot;</span><span class="p">:</span> <span class="s2">&quot;torch&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_worker_failures&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;num_gpus&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;clip_rewards&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">8e-6</span><span class="p">,</span>
        <span class="s2">&quot;lr_schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e2</span><span class="p">),</span> <span class="mf">1e-2</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">),</span> <span class="mf">1e-3</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span> <span class="mf">1e-4</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">),</span> <span class="mf">1e-5</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e6</span><span class="p">),</span> <span class="mf">1e-6</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e7</span><span class="p">),</span> <span class="mf">1e-7</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;observation_filter&quot;</span><span class="p">:</span> <span class="s2">&quot;MeanStdFilter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lambda&quot;</span><span class="p">:</span> <span class="mf">0.72</span><span class="p">,</span>
        <span class="s2">&quot;vf_loss_coeff&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;entropy_coeff&quot;</span><span class="p">:</span> <span class="mf">0.01</span>
    <span class="p">},</span>
    <span class="n">checkpoint_at_end</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>And then to restore the agent just use the following code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ray.rllib.agents.ppo</span> <span class="k">as</span> <span class="nn">ppo</span>

<span class="c1"># Get checkpoint</span>
<span class="n">checkpoints</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get_trial_checkpoints_paths</span><span class="p">(</span>
    <span class="n">trial</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">get_best_trial</span><span class="p">(</span><span class="s2">&quot;episode_reward_mean&quot;</span><span class="p">),</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;episode_reward_mean&quot;</span>
<span class="p">)</span>
<span class="n">checkpoint_path</span> <span class="o">=</span> <span class="n">checkpoints</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Restore agent</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">ppo</span><span class="o">.</span><span class="n">PPOTrainer</span><span class="p">(</span>
    <span class="n">env</span><span class="o">=</span><span class="s2">&quot;TradingEnv&quot;</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;env_config&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">25</span>
        <span class="p">},</span>
        <span class="s2">&quot;framework&quot;</span><span class="p">:</span> <span class="s2">&quot;torch&quot;</span><span class="p">,</span>
        <span class="s2">&quot;log_level&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_worker_failures&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;num_gpus&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;clip_rewards&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">8e-6</span><span class="p">,</span>
        <span class="s2">&quot;lr_schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e2</span><span class="p">),</span> <span class="mf">1e-2</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">),</span> <span class="mf">1e-3</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span> <span class="mf">1e-4</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">),</span> <span class="mf">1e-5</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e6</span><span class="p">),</span> <span class="mf">1e-6</span><span class="p">],</span>
            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e7</span><span class="p">),</span> <span class="mf">1e-7</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;observation_filter&quot;</span><span class="p">:</span> <span class="s2">&quot;MeanStdFilter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lambda&quot;</span><span class="p">:</span> <span class="mf">0.72</span><span class="p">,</span>
        <span class="s2">&quot;vf_loss_coeff&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;entropy_coeff&quot;</span><span class="p">:</span> <span class="mf">0.01</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="stable-baselines">
<h1><a class="reference external" href="https://stable-baselines.readthedocs.io/en/master/">Stable Baselines</a><a class="headerlink" href="#stable-baselines" title="Permalink to this headline">¶</a></h1>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stable_baselines.common.policies</span> <span class="kn">import</span> <span class="n">MlpLnLstmPolicy</span>
<span class="kn">from</span> <span class="nn">stable_baselines</span> <span class="kn">import</span> <span class="n">PPO2</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">PPO2</span>
<span class="n">policy</span> <span class="o">=</span> <span class="n">MlpLnLstmPolicy</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="mf">1e-5</span> <span class="p">}</span>

<span class="n">agent</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">environment</span><span class="p">,</span> <span class="n">model_kwargs</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="tensorforce">
<h1><a class="reference external" href="https://tensorforce.readthedocs.io/en/0.4.4">Tensorforce</a><a class="headerlink" href="#tensorforce" title="Permalink to this headline">¶</a></h1>
<p>I will also quickly cover the Tensorforce library to show how simple it is to switch between reinforcement learning frameworks.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorforce.agents</span> <span class="kn">import</span> <span class="n">Agent</span>

<span class="n">agent_spec</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ppo_agent&quot;</span><span class="p">,</span>
    <span class="s2">&quot;step_optimizer&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;adam&quot;</span><span class="p">,</span>
        <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="mf">1e-4</span>
    <span class="p">},</span>
    <span class="s2">&quot;discount&quot;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
    <span class="s2">&quot;likelihood_ratio_clipping&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">network_spec</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;tanh&quot;</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;tanh&quot;</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">from_spec</span><span class="p">(</span><span class="n">spec</span><span class="o">=</span><span class="n">agent_spec</span><span class="p">,</span>
                        <span class="n">kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">network_spec</span><span class="p">,</span>
                                    <span class="n">states</span><span class="o">=</span><span class="n">environment</span><span class="o">.</span><span class="n">states</span><span class="p">,</span>
                                    <span class="n">actions</span><span class="o">=</span><span class="n">environment</span><span class="o">.</span><span class="n">actions</span><span class="p">))</span>
</pre></div>
</div>
<p><em>If you would like to know more about Tensorforce agents, you can view the</em> <a class="reference external" href="https://tensorforce.readthedocs.io/en/0.4.4">Documentation.</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api/modules.html" class="btn btn-neutral float-right" title="tensortrade" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../oms/overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>