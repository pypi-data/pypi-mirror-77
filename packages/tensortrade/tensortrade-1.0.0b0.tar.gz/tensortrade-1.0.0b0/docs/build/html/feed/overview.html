

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Overview &mdash; TensorTrade 1.0.0-beta documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Overview" href="../oms/overview.html" />
    <link rel="prev" title="Overview" href="../envs/overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html#docker">Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/overview.html">Code Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/setup_environment_tutorial.html">Setup Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/train_and_evaluate.html">Train and Evaluate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/renderers_and_plotly_chart.html">Renderers and Plotly Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/use_stochastic_data.html">Stochastic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ledger_example.html">Ledger Example</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ray.html">Using Ray with TensorTrade</a></li>
</ul>
<p class="caption"><span class="caption-text">Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../components/components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/action_scheme.html">Action Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/reward_scheme.html">Reward Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/observer.html">Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/observer.html#default">Default</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/stopper.html">Stopper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/informer.html">Informer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/renderer.html">Renderer</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../envs/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../envs/overview.html#what-if-i-can-t-make-a-particular-environment">What if I can’t make a particular environment?</a></li>
</ul>
<p class="caption"><span class="caption-text">Feed</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="#what-is-a-stream">What is a <code class="docutils literal notranslate"><span class="pre">Stream</span></code>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="#using-data-types">Using Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="#advanced-usages">Advanced Usages</a></li>
</ul>
<p class="caption"><span class="caption-text">Order Management System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html#portfolio">Portfolio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oms/overview.html#orders">Orders</a></li>
</ul>
<p class="caption"><span class="caption-text">Agents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#ray">Ray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#stable-baselines">Stable Baselines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/overview.html#tensorforce">Tensorforce</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">API reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TensorTrade</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/feed/overview.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">feed</span></code> package provides useful tools when building trading environments. The primary reason for using this package is to help build the mechanisms that generate observations from an environment. Therefore, it is fitting that their primary location of use is in the <code class="docutils literal notranslate"><span class="pre">Observer</span></code> component. The <code class="docutils literal notranslate"><span class="pre">Stream</span></code> API provides the granularity needed to connect specific data sources to the <code class="docutils literal notranslate"><span class="pre">Observer</span></code>.</p>
</div>
<div class="section" id="what-is-a-stream">
<h1>What is a <code class="docutils literal notranslate"><span class="pre">Stream</span></code>?<a class="headerlink" href="#what-is-a-stream" title="Permalink to this headline">¶</a></h1>
<p>A <code class="docutils literal notranslate"><span class="pre">Stream</span></code> is the basic building block for the <code class="docutils literal notranslate"><span class="pre">DataFeed</span></code>, which is also a stream itself. Each stream has a name and a data type and they can be set after the stream is created.  Streams can be created through the following mechanisms:</p>
<ul class="simple">
<li><p>generators</p></li>
<li><p>iterables</p></li>
<li><p>sensors</p></li>
<li><p>direct implementation of <code class="docutils literal notranslate"><span class="pre">Stream</span></code></p></li>
</ul>
<p>For example, if you wanted to make a stream for a simple counter. We will make it such that it will start at 0 and increment by 1 each time it is called and on <code class="docutils literal notranslate"><span class="pre">reset</span></code> will set the count back to 0. The following code accomplishes this functionality through creating a generator function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensortrade.feed</span> <span class="kn">import</span> <span class="n">Stream</span>

<span class="k">def</span> <span class="nf">counter</span><span class="p">():</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition, you can also use the built-in <code class="docutils literal notranslate"><span class="pre">count</span></code> generator from the <code class="docutils literal notranslate"><span class="pre">itertools</span></code> package.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>These will all create infinite streams that will keep incrementing by 1 to infinity. If you wanted to make something that counted until some finite number you can use the built in <code class="docutils literal notranslate"><span class="pre">range</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>This can also be done by giving in a <code class="docutils literal notranslate"><span class="pre">list</span></code> directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">source</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>The direct approach to stream creation is by subclassing <code class="docutils literal notranslate"><span class="pre">Stream</span></code> and implementing the <code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">has_next</span></code>, and <code class="docutils literal notranslate"><span class="pre">reset</span></code> methods. If the stream does not hold stateful information, then <code class="docutils literal notranslate"><span class="pre">reset</span></code> is not required to be implemented and can be ignored.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Counter</span><span class="p">(</span><span class="n">Stream</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>

    <span class="k">def</span> <span class="nf">has_next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
</pre></div>
</div>
<p>There is also a way of creating streams which serves the purpose of watching a particular object and how it changes over time. This can be done through the <code class="docutils literal notranslate"><span class="pre">sensor</span></code> function. For example, we can use this to directly track performance statistics on our <code class="docutils literal notranslate"><span class="pre">portfolio</span></code>. Here is a specific example of how we can use it to track the number of orders the are currently active inside the order management system.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensortrade.env.default.actions</span> <span class="kn">import</span> <span class="n">SimpleOrders</span>

<span class="n">action_scheme</span> <span class="o">=</span> <span class="n">SimpleOrders</span><span class="p">()</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">sensor</span><span class="p">(</span><span class="n">action_scheme</span><span class="o">.</span><span class="n">broker</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">b</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">unexecuted</span><span class="p">))</span>
</pre></div>
</div>
<p>As the agent and the environment are interacting with one another, this stream will be able to monitor the number of active orders being handled by the broker. This stream can then be used by either computing performance statistics and supplying them to a <code class="docutils literal notranslate"><span class="pre">Renderer</span></code> or simply by including it within the observation space.</p>
<p>Now that we have seen the different ways we can create streams, we need to understand the ways in which we can aggregate new streams from old. This is where the data type of a stream becomes important.</p>
</div>
<div class="section" id="using-data-types">
<h1>Using Data Types<a class="headerlink" href="#using-data-types" title="Permalink to this headline">¶</a></h1>
<p>The purpose of the data type of a stream, <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, is to add additional functionality and behavior to a stream such that it can be aggregated with other streams of the same type in an easy and intuitive way. For example, what if the number of executed orders from the <code class="docutils literal notranslate"><span class="pre">broker</span></code> is not important by itself, but is important with respect to the current time of the process. This can be taken into account if we create a stream for keeping count of the active orders and another one for keeping track of the step in the process. Here is what that would look like.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>

<span class="kn">from</span> <span class="nn">tensortrade.feed</span> <span class="kn">import</span> <span class="n">Stream</span>
<span class="kn">from</span> <span class="nn">tensortrade.env.default.actions</span> <span class="kn">import</span> <span class="n">SimpleOrders</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
<span class="n">n_active</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">sensor</span><span class="p">(</span><span class="n">action_scheme</span><span class="o">.</span><span class="n">broker</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">b</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">unexecuted</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_active</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;avg_n_active&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Suppose we find that this is not a useful statistic and instead would like to know how many of the active order have been filled since the last time step. This can be done by using the <code class="docutils literal notranslate"><span class="pre">lag</span></code> operator on our stream and finding the difference between the current count and the count from the last time step.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_active</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">sensor</span><span class="p">(</span><span class="n">action_scheme</span><span class="o">.</span><span class="n">broker</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">b</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">unexecuted</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_active</span> <span class="o">-</span> <span class="n">n_active</span><span class="o">.</span><span class="n">lag</span><span class="p">())</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;n_filled&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see from the code above, we were able to make more complex streams by using simple ones. Take note, however, in the way we use the <code class="docutils literal notranslate"><span class="pre">rename</span></code> function. We only really want to rename a stream if we will be using it somewhere else where its name will be useful (e.g. in our <code class="docutils literal notranslate"><span class="pre">feed</span></code>). We do not want to name all the intermediate streams that are used to build our final statistic because the code will become too cumbersome and annoying. To avoid these complications, streams are created to automatically generate a unique name on instantiation. We leave the naming for the user to decide which streams are useful to name.</p>
<p>Since the most common data type is <code class="docutils literal notranslate"><span class="pre">float</span></code> in these tasks, the following is a list of supported special operations for it:</p>
<ul class="simple">
<li><p>Let <code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">s1</span></code>, <code class="docutils literal notranslate"><span class="pre">s2</span></code> be streams.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">c</span></code> be a constant.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">n</span></code> be a number.</p></li>
<li><p>Unary:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">-s</span></code>, <code class="docutils literal notranslate"><span class="pre">s.neg()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">abs(s)</span></code>, <code class="docutils literal notranslate"><span class="pre">s.abs()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s**2</span></code>, <code class="docutils literal notranslate"><span class="pre">pow(s,</span> <span class="pre">n)</span></code></p></li>
</ul>
</li>
<li><p>Binary:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">+</span> <span class="pre">s2</span></code>, <code class="docutils literal notranslate"><span class="pre">s1.add(s2)</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">+</span> <span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">+</span> <span class="pre">s</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">-</span> <span class="pre">s2</span></code>, <code class="docutils literal notranslate"><span class="pre">s1.sub(s2)</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">-</span> <span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">-</span> <span class="pre">s</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">*</span> <span class="pre">s2</span></code>, <code class="docutils literal notranslate"><span class="pre">s1.mul(s2)</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">*</span> <span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">*</span> <span class="pre">s</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">/</span> <span class="pre">s2</span></code>, <code class="docutils literal notranslate"><span class="pre">s1.div(s2)</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">/</span> <span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">/</span> <span class="pre">s</span></code></p></li>
</ul>
</li>
</ul>
<p>There are many more useful functions that can be utilized, too many to list in fact. You can find all of the. however, in the API reference section of the documentation.</p>
</div>
<div class="section" id="advanced-usages">
<h1>Advanced Usages<a class="headerlink" href="#advanced-usages" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">Stream</span></code> API is very robust and can handle complex streaming operations, particularly for the <code class="docutils literal notranslate"><span class="pre">float</span></code> data type. Some of the more advanced usages include performance tracking and developing reward schemes for the <code class="docutils literal notranslate"><span class="pre">default</span></code> trading environment. In the following example, we will show how to track the net worth of a portfolio. This implementation will be coming directly from the wallets that are defined in the <code class="docutils literal notranslate"><span class="pre">portfolio</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suppose we have an already constructed portfolio object, `portfolio`.</span>

<span class="n">worth_streams</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">wallet</span> <span class="ow">in</span> <span class="n">portfolio</span><span class="o">.</span><span class="n">wallets</span><span class="p">:</span>

    <span class="n">total_balance</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">sensor</span><span class="p">(</span>
        <span class="n">wallet</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">total_balance</span><span class="o">.</span><span class="n">as_float</span><span class="p">(),</span>
        <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float&quot;</span>
    <span class="p">)</span>

    <span class="n">symbol</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">instrument</span><span class="o">.</span><span class="n">symbol</span>

    <span class="k">if</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">portfolio</span><span class="o">.</span><span class="n">base_instrument</span><span class="o">.</span><span class="n">symbol</span>
        <span class="n">worth_streams</span> <span class="o">+=</span> <span class="p">[</span><span class="n">total_balance</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">price</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">w</span><span class="o">.</span><span class="n">exchange</span><span class="o">.</span><span class="n">streams</span><span class="p">(),</span>
            <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">worth_streams</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">price</span> <span class="o">*</span> <span class="n">total_balance</span><span class="p">)]</span>

<span class="n">net_worth</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">worth_streams</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;net_worth&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../oms/overview.html" class="btn btn-neutral float-right" title="Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../envs/overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>